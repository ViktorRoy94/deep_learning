# Задача классификации персонажей Симпсонов

## Постановка задачи

В данных лабораторных работах решается задача распознавания персонажей из мультфильма "Симпсоны". Имеется множество объектов X - изображения персонажей, 
и конечное множество меток Y - номера классов рассматриваемых объектов, соответствующие именам восемнадцати героев.
Существует некоторая зависимость ƒ*:X→Y, значения которой известны только на объектах обучающей выборки.
Требуется по произвольной картинке определить, какой персонаж на ней изображён.

## Тренировочные и тестовые наборы данных

Набор данных [«The Simpsons Characters Data»]( https://www.kaggle.com/alexattia/the-simpsons-characters-dataset/data) 
содержит рисунки для 18 персонажей из мультфильма «Симпсоны». Изначально данные не разделены на обучающую и тестовую выборки. 
Количество картинок для каждого персонажа указано в таблице.

  №   |         Name                  |   Total     
------|-------------------------------|----------
  1   | Homer Simpson                 |   2246     
  2   | Ned Flanders                  |   1454       
  3   | Moe Szyslak                   |   1452      
  4   | Lisa Simpson                  |   1354    
  5   | Bart Simpson                  |   1342      
  6   | Marge Simpson                 |   1291   
  7   | Krusty The Clown              |   1206   
  8   | Principal Skinner             |   1194   
  9   | Charles Montgomery Burns      |   1193   
  10  | Milhouse Van Houten           |   1079   
  11  | Chief Wiggum                  |    986   
  12  | Abraham Grampa Simpson        |    913   
  13  | Sideshow Bob                  |    877   
  14  | Apu Nahasapeemapetilon        |    623   
  15  | Kent Brockman                 |    498   
  16  | Comic Book Guy                |    469   
  17  | Edna Krabappel                |    457   
  18  | Nelson Muntz                  |    358   

## Метрика качества решения задачи

Качество решения рассматриваемой задачи оценивается с помощью метрики – точность классификации.
$$Accuracy(y, y')=\frac{1}{N}\sum_{i=0}^{N-1}I(y==y')$$
<center>
где
N – количество изображений в выборке,  
y - истинная метка,   
y' - предсказанная метка,  
I(y == y') – индикаторная функция, которая принимает значение 1, если y == y'.
</center>

## Исходный формат хранения данных

Исходные данные хранятся в виде .jpg изображений различного разрешения. Данные разделены по папкам, названным по имени персонажа.
Для дальнейшего использования данных в задаче классификации из них были удалены картинки, на которых изображён более чем один персонаж.
Общее число картинок составило 17524.
Изменённый набор данных доступен по [cсылке](https://yadi.sk/d/dtnDZ7KP3QgfWb).

## Разработанные скрипты

* read_write_data.py – скрипт для предобработки входных данных.
* lab2/simpson_fcnn.py – скрипт для описания и обучения полностью связанной нейронной сети.
* lab3/simpson_cnn.py – скрипт для описания и обучения свёрточной нейронной сети.
* lab4/autoencoder_simpsons.py - скрипт для начальной настройки весов однослойной нейронной сети с помощью автокодировщика.
* lab4/stack_autoencoders_simpsons.py - скрипт для начальной настройки весов многослоной нейронной сети с помощью стека автокодировщиков.
* lab5/transferLearning_2.py - скрипт, реализующий второй тип экспериментов при переносе обучения.
* lab5/transferLearning_3.py - скрипт, реализующий третий тип экспериментов при переносе обучения.
* lab5/transferLearning_4.py - скрипт, реализующий четвёртый тип экспериментов при переносе обучения.

Все скрипты написаны в формате, доступном библиотеке MXNet.

## Тестовая инфраструктура

Эксперименты проводились на компьютере со следующей конфигурацией: 
процессор Intel® Core™ i3-5005U CPU @ 2.00GHz 2.00GHz, 
установленная память (ОЗУ) 4.00 ГБ, 
64-разрядная операционная система Windows 8.1, 
интерпретатор Python 2.7.

## Результаты экспериментов
|Название                    |Время|Точность|
|:---:                       |:---:|:---:   |
|FCNN                        |860  |0.8327  |
|CNN                         |2990 |0.8924  |
|FCNN+autoencoder stack      |1206 |0.8585  |
|Transfer learning(resnet-18)|17584|0.8764  |

